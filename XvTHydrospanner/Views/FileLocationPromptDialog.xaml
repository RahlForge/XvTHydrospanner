<Window x:Class="XvTHydrospanner.Views.FileLocationPromptDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Specify File Locations" Height="550" Width="750"
        WindowStartupLocation="CenterOwner"
        Background="#1E1E1E">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <TextBlock Grid.Row="0" TextWrapping="Wrap" Foreground="White" Margin="0,0,0,15">
            <Run Text="The following files have no folder structure defined in the archive."/>
            <LineBreak/>
            <Run Text="Please specify the target location(s) for each file. Use the + button to add multiple locations."/>
        </TextBlock>
        
        <!-- File List -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="0,0,0,15">
            <ItemsControl x:Name="FilesListControl" ItemsSource="{Binding}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Background="#2D2D30" BorderBrush="#3F3F46" BorderThickness="1" 
                                Padding="10" Margin="0,0,0,10">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- File Name -->
                                <TextBlock Grid.Row="0" Text="{Binding FileName}" 
                                          Foreground="White" FontWeight="SemiBold" 
                                          Margin="0,0,0,8"/>
                                
                                <!-- Locations -->
                                <StackPanel Grid.Row="1">
                                    <ItemsControl ItemsSource="{Binding SelectedLocations}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Margin="0,0,0,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    
                                                    <!-- Location ComboBox -->
                                                    <ComboBox Grid.Column="0" 
                                                              ItemsSource="{Binding DataContext.AvailableLocations, RelativeSource={RelativeSource AncestorType=Border}}"
                                                              SelectedItem="{Binding Path=., Mode=TwoWay}"
                                                              Background="#FFFFFF" 
                                                              Foreground="#000000" 
                                                              BorderBrush="#3F3F46"
                                                              Padding="8,5"
                                                              SelectionChanged="LocationComboBox_SelectionChanged"
                                                              IsEditable="False"
                                                              IsReadOnly="True">
                                                        <ComboBox.Resources>
                                                            <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#FFFFFF"/>
                                                            <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="#000000"/>
                                                            <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" Color="#FFFFFF"/>
                                                            <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}" Color="#000000"/>
                                                            <SolidColorBrush x:Key="{x:Static SystemColors.WindowBrushKey}" Color="#FFFFFF"/>
                                                            <SolidColorBrush x:Key="{x:Static SystemColors.WindowTextBrushKey}" Color="#000000"/>
                                                            <SolidColorBrush x:Key="{x:Static SystemColors.ControlTextBrushKey}" Color="#000000"/>
                                                            <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="#FFFFFF"/>
                                                            <SolidColorBrush x:Key="{x:Static SystemColors.GrayTextBrushKey}" Color="#000000"/>
                                                            <Style TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
                                                                <Setter Property="SelectionBrush" Value="#3399FF"/>
                                                                <Setter Property="SelectionTextBrush" Value="#FFFFFF"/>
                                                                <Setter Property="Foreground" Value="#000000"/>
                                                                <Setter Property="CaretBrush" Value="#000000"/>
                                                            </Style>
                                                            <Style TargetType="ContentPresenter">
                                                                <Setter Property="TextElement.Foreground" Value="#000000"/>
                                                            </Style>
                                                        </ComboBox.Resources>
                                                        <ComboBox.ItemContainerStyle>
                                                            <Style TargetType="ComboBoxItem">
                                                                <Setter Property="Background" Value="#2D2D30"/>
                                                                <Setter Property="Foreground" Value="#FFFFFF"/>
                                                                <Setter Property="Padding" Value="8,5"/>
                                                                <Setter Property="BorderThickness" Value="0"/>
                                                                <Style.Triggers>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter Property="Background" Value="#E0E0E0"/>
                                                                        <Setter Property="Foreground" Value="#000000"/>
                                                                    </Trigger>
                                                                    <Trigger Property="IsHighlighted" Value="True">
                                                                        <Setter Property="Background" Value="#E0E0E0"/>
                                                                        <Setter Property="Foreground" Value="#000000"/>
                                                                    </Trigger>
                                                                    <Trigger Property="IsSelected" Value="True">
                                                                        <Setter Property="Background" Value="#CCCCCC"/>
                                                                        <Setter Property="Foreground" Value="#000000"/>
                                                                    </Trigger>
                                                                    <MultiTrigger>
                                                                        <MultiTrigger.Conditions>
                                                                            <Condition Property="IsSelected" Value="True"/>
                                                                            <Condition Property="IsHighlighted" Value="True"/>
                                                                        </MultiTrigger.Conditions>
                                                                        <Setter Property="Background" Value="#E0E0E0"/>
                                                                        <Setter Property="Foreground" Value="#000000"/>
                                                                    </MultiTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </ComboBox.ItemContainerStyle>
                                                        <ComboBox.Style>
                                                            <Style TargetType="ComboBox">
                                                                <Setter Property="Background" Value="#FFFFFF"/>
                                                                <Setter Property="Foreground" Value="#000000"/>
                                                                <Setter Property="BorderBrush" Value="#3F3F46"/>
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    
                                                    <!-- Remove Button -->
                                                    <Button Grid.Column="1" Content="âˆ’" Width="30" Height="30" 
                                                            Margin="5,0,0,0" Background="#D13438" Foreground="White" 
                                                            BorderThickness="0" FontSize="16" FontWeight="Bold"
                                                            Click="RemoveLocationButton_Click"
                                                            Tag="{Binding DataContext, RelativeSource={RelativeSource AncestorType=Border}}"
                                                            ToolTip="Remove this location">
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="Cursor" Value="Hand"/>
                                                                <Style.Triggers>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter Property="Background" Value="#F14C4C"/>
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                    
                                                    <!-- Add Button -->
                                                    <Button Grid.Column="2" Content="+" Width="30" Height="30" 
                                                            Margin="5,0,0,0" Background="#0E639C" Foreground="White" 
                                                            BorderThickness="0" FontSize="16" FontWeight="Bold"
                                                            Click="AddLocationButton_Click"
                                                            Tag="{Binding DataContext, RelativeSource={RelativeSource AncestorType=Border}}"
                                                            ToolTip="Add another location for this file">
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="Cursor" Value="Hand"/>
                                                                <Style.Triggers>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter Property="Background" Value="#1177BB"/>
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
        
        <!-- Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="OK" Width="100" Padding="10,5" Margin="0,0,10,0"
                    Click="OkButton_Click" IsDefault="True">
                <Button.Style>
                    <Style TargetType="Button">
                        <Setter Property="Background" Value="#0E639C"/>
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Cursor" Value="Hand"/>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#1177BB"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>
            <Button Content="Cancel" Width="100" Padding="10,5" IsCancel="True"
                    Background="#3F3F46" Foreground="White" BorderThickness="0"/>
        </StackPanel>
    </Grid>
</Window>

